(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function d(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(t){if(t.ep)return;t.ep=!0;const o=d(t);fetch(t.href,o)}})();async function y(c,e,d){try{const t=location.hostname==="localhost"?"/api/0.3":"https://www.carqueryapi.com/api/0.3",o=`{baseUrl}?cmd=getModels&make=${e}&year=${c}&sold_in_us=1`;console.log("Requesting URL:",o);const n=await fetch(o);if(console.log(o),!n.ok)throw console.error("Failed request with status:",n.status),new Error(`API request failed with status: ${n.status}`);const a=(await n.json()).Models,m=document.getElementById(d);m.innerHTML="";const p=document.createElement("option");p.text="Select Model",p.value="",m.appendChild(p),a.forEach(r=>{const s=document.createElement("option");s.text=r.model_name,s.value=r.model_name,m.appendChild(s)})}catch(l){console.error("Error fetching models:",l)}}async function v(c,e,d,l){try{const t=`/api/0.3/?cmd=getTrims&make=${e}&year=${c}&model=${d}&sold_in_us=1`,i=(await(await fetch(t)).text()).replace(/^.*?({.*})[^}]*$/,"$1"),m=JSON.parse(i).Trims;console.log(t);const p=document.getElementById(l);p.innerHTML="";const r=document.createElement("option");r.text="Select Trim",r.value="",p.appendChild(r),m.forEach(s=>{const u=document.createElement("option");u.text=s.model_trim||"Base",u.value=s.model_trim,u.dataset.modelId=s.model_id,p.appendChild(u)})}catch(t){console.error("Error fetching trims:",t)}}async function w(c){try{const e=`/api/0.3/?cmd=getModel&model=${c}`;console.log("Fetching car details from:",e);const d=await fetch(e);if(!d.ok)throw console.error("API request failed with status:",d.status),new Error(`API request failed with status: ${d.status}`);const l=await d.json();if(console.log("Car details response data:",l),l&&l.length>0)return l[0];throw console.error("No car details returned from API"),new Error("No car details found")}catch(e){return console.error("Error fetching car details:",e),{}}}async function L(c,e,d){try{const t=await(await fetch(`https://www.carimagery.com/api.asmx/GetImageUrl?searchTerm=${d}+${c}+${e}`)).text();return new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("string")[0].textContent}catch(l){return console.error("Error fetching car image:",l),null}}async function _(c,e){if(!e.model_make_display||!e.model_name||!e.model_year){c.innerHTML="<p>Sorry, car details could not be loaded.</p>";return}const d=await L(e.model_make_display,e.model_name,e.model_year);if(!d){c.innerHTML="<p>Car image could not be loaded.</p>";return}c.innerHTML=`
    <h2>${e.model_make_display} ${e.model_name} ${e.model_year}</h2>
    <img src="${d}" alt="${e.model_make_display} ${e.model_name}" style="max-width: 100%; height: auto; border-radius: 8px;">
    <p>Trim: ${e.model_trim||"N/A"}</p>
    <p>MPG (City): ${e.model_mpg_city||"N/A"} mpg</p>
    <p>MPG (Highway): ${e.model_mpg_hwy||"N/A"} mpg</p>
    <p>MPG (Average): ${e.model_mpg_mixed||"N/A"} mpg</p>
    <p>Engine Size: ${e.model_engine_l||"N/A"}L</p>
    <p>Horsepower: ${e.model_engine_power_hp||"N/A"} hp</p>
    <p>Torque: ${e.model_engine_torque_lbft||"N/A"} lb-ft</p>
    <p>RPM: ${e.model_engine_power_rpm||"N/A"}</p>
    <p>Drivetrain: ${e.model_drive||"N/A"}</p>
    <p>Stock Tire Size: ${e.model_tire_size||"N/A"}</p>
    <p>Fuel Tank Size: ${e.model_fuel_cap_g||"N/A"} gallons</p>
  `}document.addEventListener("DOMContentLoaded",()=>{const c=["Acura","BMW","Buick","Cadillac","Chevrolet","Chrysler","Dodge","Ford","GMC","Genesis","Honda","Hyundai","Infiniti","Jeep","Kia","Lexus","Lincoln","Mazda","Mercedes-Benz","Mini","Nissan","Porsche","Ram","Subaru","Toyota","Volkswagen","Volvo"],e=new Date().getFullYear(),d=Array.from({length:e-1990+1},(o,n)=>e-n);function l(o){const n=document.getElementById(o);d.forEach(i=>{const a=document.createElement("option");a.value=i,a.textContent=i,n.appendChild(a)})}function t(o){const n=document.getElementById(o);c.forEach(i=>{const a=document.createElement("option");a.value=i,a.textContent=i,n.appendChild(a)})}[1,2,3].forEach(o=>{l(`yearDropdown${o}`),t(`makeDropdown${o}`);const n=document.getElementById(`yearDropdown${o}`),i=document.getElementById(`makeDropdown${o}`),a=document.getElementById(`modelDropdown${o}`),m=document.getElementById(`trimDropdown${o}`),p=document.getElementById(`carDetailsContainer${o}`);n.addEventListener("change",()=>{const r=n.value,s=i.value;r&&s&&(y(r,s,`modelDropdown${o}`),m.innerHTML='<option value="">Select Trim</option>',p.innerHTML="")}),i.addEventListener("change",()=>{const r=n.value,s=i.value;r&&s&&(y(r,s,`modelDropdown${o}`),m.innerHTML='<option value="">Select Trim</option>',p.innerHTML="")}),a.addEventListener("change",()=>{const r=n.value,s=i.value,u=a.value;r&&s&&u&&v(r,s,u,`trimDropdown${o}`)}),m.addEventListener("change",async()=>{var u;const r=m.selectedOptions[0],s=(u=r==null?void 0:r.dataset)==null?void 0:u.modelId;if(s){const g=await w(s);_(p,g)}}),[i,a,m].forEach(r=>{r.addEventListener("change",()=>{const s=n.value,u=i.value,g=a.value,$=m.value;if(s&&u&&g&&$){const f=m.options[m.selectedIndex],h=f==null?void 0:f.dataset.modelId;h?(console.log("Selected model_id:",h),w(h).then(E=>_(p,E))):console.warn("No model_id found for selected trim")}})})}),document.querySelectorAll(".addCarBtn").forEach(o=>{o.addEventListener("click",()=>{const n=o.getAttribute("data-car");document.getElementById(`carForm${n}`).classList.remove("hidden"),o.style.display="none"})})});
